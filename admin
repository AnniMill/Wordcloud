# pages/1_Admin.py
import streamlit as st
import pandas as pd
import os

st.set_page_config(page_title="Admin Panel", layout="wide")
st.title("üõ†Ô∏è Admin Panel: Wordcloud Dashboard")

file_path = "submissions.csv"

if os.path.exists(file_path):
    df = pd.read_csv(file_path)
    st.subheader("üìã Live Response Log")
    st.dataframe(df)

    if st.button("Download CSV"):
        st.download_button(
            label="Download Submissions",
            data=df.to_csv(index=False),
            file_name="responses.csv",
            mime="text/csv"
        )
else:
    st.info("No submissions yet. Responses will appear here in real-time.")
st.subheader("üéõÔ∏è Word Cloud Customization")

col1, col2 = st.columns(2)
with col1:
    bg_color = st.color_picker("Background Color", "#FFFFFF")
    colormap = st.selectbox("Color Scheme", ["viridis", "plasma", "inferno", "magma", "cividis", "Set3", "Pastel1"])
with col2:
    max_words = st.slider("Max Words", min_value=20, max_value=200, value=100, step=10)
    random_state = st.slider("Random Seed (for layout)", 0, 100, 42)
from wordcloud import WordCloud
import matplotlib.pyplot as plt

st.subheader("üå•Ô∏è Live Word Cloud")

# Load data and combine responses
if os.path.exists("submissions.csv"):
    df = pd.read_csv("submissions.csv")

    # Combine all responses into one text blob
    text = " ".join(df["response1"].dropna().tolist() + df["response2"].dropna().tolist())

    if text:
        wc = WordCloud(
            width=800,
            height=400,
            background_color="white",
            colormap="viridis",
            prefer_horizontal=0.9
        ).generate(text)

        fig, ax = plt.subplots(figsize=(10, 5))
        ax.imshow(wc, interpolation="bilinear")
        ax.axis("off")

        st.pyplot(fig)
    else:
        st.warning("No responses yet for the word cloud.")
else:
    st.info("Waiting for responses to generate the word cloud...")
